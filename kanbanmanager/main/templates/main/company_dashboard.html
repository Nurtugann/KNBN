{% extends 'main/base.html' %}
{% block title %}–î–∞—à–±–æ—Ä–¥: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º{% endblock %}

{% block extra_css %}
<style>
  .card {
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    border-radius: 10px;
    padding: 1rem;
    margin-bottom: 1rem;
  }
  .card-title {
    font-size: 1.1rem;
    font-weight: bold;
  }
  .region-table th, .region-table td {
    padding: 0.4rem 0.8rem;
    font-size: 0.9rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="mb-4">üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–º–ø–∞–Ω–∏—è–º</h1>

  <div class="row">
    <div class="col-md-3">
      <div class="card bg-light">
        <div class="card-title">–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π</div>
        <div class="display-6">{{ total_companies }}</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-warning">
        <div class="card-title">–°—É–º–º–∞—Ä–Ω—ã–π –¥–æ–ª–≥</div>
        <div class="display-6">{{ total_debt|floatformat:0 }} ‚Ç∏</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-title">–ü–æ–≥–∞—à–µ–Ω–æ</div>
        <div class="display-6">{{ total_repaid|floatformat:0 }} ‚Ç∏</div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-danger text-white">
        <div class="card-title">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
        <div class="display-6">{{ overdue_count }}</div>
      </div>
    </div>
  </div>

  <h3 class="mt-4">üìç –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º</h3>
  <table class="table table-bordered region-table">
    <thead class="table-light">
      <tr>
        <th>–†–µ–≥–∏–æ–Ω</th>
        <th>–ö–æ–º–ø–∞–Ω–∏–π</th>
        <th>–û–±—â–∏–π –¥–æ–ª–≥</th>
        <th>–ü–æ–≥–∞—à–µ–Ω–æ</th>
        <th>–ü–æ–≥–∞—à–µ–Ω–æ %</th>  {# üëà –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É #}
      </tr>
    </thead>
    <tbody>
      {% for region in region_stats %}
      <tr>
        <td>{{ region.region }}</td>
        <td>{{ region.count }}</td>
        <td>{{ region.debt|floatformat:0 }} ‚Ç∏</td>
        <td>{{ region.paid|floatformat:0 }} ‚Ç∏</td>
        <td>
          {% if region.debt > 0 %}
            {{ region.paid|divisibleby:region.debt|floatformat:2 }}%
          {% else %}
            ‚Äî
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h3 class="mt-4">‚öñÔ∏è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h3>
  <table class="table table-bordered region-table">
    <thead class="table-light">
      <tr>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–ö–æ–º–ø–∞–Ω–∏–π</th>
      </tr>
    </thead>
    <tbody>
      {% for s in status_stats %}
      <tr>
        <td>{{ s.status__name }}</td>
        <td>{{ s.count }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</div>
{% endblock %}
